const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/geometryEngineJSON-RNRrFqly.js","assets/geometryEngineBase-C0k-Dc0I.js","assets/_commonjsHelpers-DCkdB7M8.js","assets/json-BLezgqVO.js"])))=>i.map(i=>d[i]);
import{kf as U,kg as D,aJ as F,aB as $,kh as J,ki as Z,s as b,dQ as O,_ as L,dL as W}from"./index-CorgkmYx.js";import{h as B,U as H,H as K,$ as Q,P as M,a as v,I as z,K as q}from"./featureConversionUtils-CW0ryXfc.js";import{s as G}from"./OptimizedFeature-D3320lj0.js";import{x as X}from"./queryUtils-CwRl2kBy.js";const C=new G,ee=new G,w=new G,R={esriGeometryPoint:M,esriGeometryPolyline:Q,esriGeometryPolygon:K,esriGeometryMultipoint:H};function Pe(e,t,n,i=e.hasZ,s=e.hasM){if(t==null)return null;const r=e.hasZ&&i,l=e.hasM&&s;if(n){const u=v(w,t,e.hasZ,e.hasM,"esriGeometryPoint",n,i,s);return M(u,r,l)}return M(t,r,l)}function E(e,t,n,i,s,r,l=t,u=n){var f,p,I;const o=t&&l,a=n&&u,c=i!=null?"coords"in i?i:i.geometry:null;if(c==null)return null;if(s){let m=B(ee,c,t,n,e,s,l,u);return r&&(m=v(w,m,o,a,e,r)),((f=R[e])==null?void 0:f.call(R,m,o,a))??null}if(r){const m=v(w,c,t,n,e,r,l,u);return((p=R[e])==null?void 0:p.call(R,m,o,a))??null}return z(C,c,t,n,l,u),((I=R[e])==null?void 0:I.call(R,C,o,a))??null}function Ee(e){return e&&x in e?JSON.parse(JSON.stringify(e,te)):e}const x="_geVersion",te=(e,t)=>e!==x?t:void 0;function A(e,t){return e?t?4:3:t?3:2}function $e(e,t,n,i){if(!(t!=null&&t.lengths.length))return null;e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0);const s=e.coords,r=[],l=n?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:u,coords:o}=t,a=A(n,i);let c=0;for(const f of u){const p=re(l,o,c,f,n,i);p&&r.push(p),c+=f*a}if(r.sort((f,p)=>{let I=f[2]-p[2];return I===0&&n&&(I=f[4]-p[4]),I}),r.length){let f=6*r[0][2];s[0]=r[0][0]/f,s[1]=r[0][1]/f,n&&(f=6*r[0][4],s[2]=f!==0?r[0][3]/f:0),(s[0]<l[0]||s[0]>l[1]||s[1]<l[2]||s[1]>l[3]||n&&(s[2]<l[4]||s[2]>l[5]))&&(s.length=0)}if(!s.length){const f=t.lengths[0]?ne(o,0,u[0],n,i):null;if(!f)return null;s[0]=f[0],s[1]=f[1],n&&f.length>2&&(s[2]=f[2])}return e}function re(e,t,n,i,s,r){const l=A(s,r);let u=n,o=n+l,a=0,c=0,f=0,p=0,I=0;for(let S=0,P=i-1;S<P;S++,u+=l,o+=l){const h=t[u],N=t[u+1],d=t[u+2],y=t[o],g=t[o+1],Y=t[o+2];let T=h*g-y*N;p+=T,a+=(h+y)*T,c+=(N+g)*T,s&&(T=h*Y-y*d,f+=(d+Y)*T,I+=T),h<e[0]&&(e[0]=h),h>e[1]&&(e[1]=h),N<e[2]&&(e[2]=N),N>e[3]&&(e[3]=N),s&&(d<e[4]&&(e[4]=d),d>e[5]&&(e[5]=d))}if(p>0&&(p*=-1),I>0&&(I*=-1),!p)return null;const m=[a,c,.5*p];return s&&(m[3]=f,m[4]=.5*I),m}function ne(e,t,n,i,s){const r=A(i,s);let l=t,u=t+r,o=0,a=0,c=0,f=0;for(let p=0,I=n-1;p<I;p++,l+=r,u+=r){const m=e[l],S=e[l+1],P=e[l+2],h=e[u],N=e[u+1],d=e[u+2],y=i?ie(m,S,P,h,N,d):se(m,S,h,N);if(y)if(o+=y,i){const g=oe(m,S,P,h,N,d);a+=y*g[0],c+=y*g[1],f+=y*g[2]}else{const g=le(m,S,h,N);a+=y*g[0],c+=y*g[1]}}return o>0?i?[a/o,c/o,f/o]:[a/o,c/o]:n>0?i?[e[t],e[t+1],e[t+2]]:[e[t],e[t+1]]:null}function se(e,t,n,i){const s=n-e,r=i-t;return Math.sqrt(s*s+r*r)}function ie(e,t,n,i,s,r){const l=i-e,u=s-t,o=r-n;return Math.sqrt(l*l+u*u+o*o)}function le(e,t,n,i){return[e+.5*(n-e),t+.5*(i-t)]}function oe(e,t,n,i,s,r){return[e+.5*(i-e),t+.5*(s-t),n+.5*(r-n)]}function ue(e){return e==="mesh"?U:D(e)}function j(e,t){return e?t?4:3:t?3:2}function ae(e,t,n,i){return k(e,t,n,i.coords[0],i.coords[1])}function fe(e,t,n,i,s,r){const l=j(s,r),{coords:u,lengths:o}=i;if(!o)return!1;for(let a=0,c=0;a<o.length;a++,c+=l)if(!k(e,t,n,u[c],u[c+1]))return!1;return!0}function k(e,t,n,i,s){if(!e)return!1;const r=j(t,n),{coords:l,lengths:u}=e;let o=!1,a=0;for(const c of u)o=ce(o,l,r,a,c,i,s),a+=c*r;return o}function ce(e,t,n,i,s,r,l){let u=e,o=i;for(let a=i,c=i+s*n;a<c;a+=n){o=a+n,o===c&&(o=i);const f=t[a],p=t[a+1],I=t[o],m=t[o+1];(p<l&&m>=l||m<l&&p>=l)&&f+(l-p)/(m-p)*(I-f)<r&&(u=!u)}return u}const _="unsupported-query",pe={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},V={spatialRelationship:{esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},queryGeometry:{esriGeometryPoint:!0,esriGeometryMultiPatch:!1,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},layerGeometry:{esriGeometryPoint:!0,esriGeometryMultiPatch:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1}};function me(e){return e!=null&&V.spatialRelationship[e]===!0}function Ie(e){return e!=null&&V.queryGeometry[W(e)]===!0}function he(e){return e!=null&&V.layerGeometry[e]===!0}function Ne(){return L(()=>import("./geometryEngineJSON-RNRrFqly.js").then(e=>e.g),__vite__mapDeps([0,1,2,3]))}function be(e,t,n,i,s){if(F(t)&&n==="esriGeometryPoint"&&(e==="esriSpatialRelIntersects"||e==="esriSpatialRelContains")){const r=q(new G,t,!1,!1);return Promise.resolve(l=>ae(r,!1,!1,l))}if(F(t)&&n==="esriGeometryMultipoint"){const r=q(new G,t,!1,!1);if(e==="esriSpatialRelContains")return Promise.resolve(l=>fe(r,!1,!1,l,i,s))}if($(t)&&n==="esriGeometryPoint"&&(e==="esriSpatialRelIntersects"||e==="esriSpatialRelContains"))return Promise.resolve(r=>J(t,E(n,i,s,r)));if($(t)&&n==="esriGeometryMultipoint"&&e==="esriSpatialRelContains")return Promise.resolve(r=>Z(t,E(n,i,s,r)));if($(t)&&e==="esriSpatialRelIntersects"){const r=ue(n);return Promise.resolve(l=>r(t,E(n,i,s,l)))}return Ne().then(r=>{const l=r[pe[e]].bind(null,t.spatialReference,t);return u=>l(E(n,i,s,u))})}async function _e(e,t,n){var r;const{spatialRel:i,geometry:s}=e;if(s){if(!me(i))throw new b(_,"Unsupported query spatial relationship",{query:e});if(O(s.spatialReference)&&O(n)){if(!Ie(s))throw new b(_,"Unsupported query geometry type",{query:e});if(!he(t))throw new b(_,"Unsupported layer geometry type",{query:e});if(e.outSR)return X((r=e.geometry)==null?void 0:r.spatialReference,e.outSR)}}}function Fe(e){if($(e))return!0;if(F(e)){for(const t of e.rings)if(t.length!==5||t[0][0]!==t[1][0]||t[0][0]!==t[4][0]||t[2][0]!==t[3][0]||t[0][1]!==t[3][1]||t[0][1]!==t[4][1]||t[1][1]!==t[2][1])return!1;return!0}return!1}async function Me(e,t){if(!e)return null;const n=t.featureAdapter,{startTimeField:i,endTimeField:s}=e;let r=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY;if(i&&s)await t.forEach(u=>{const o=n.getAttribute(u,i),a=n.getAttribute(u,s);o==null||isNaN(o)||(r=Math.min(r,o)),a==null||isNaN(a)||(l=Math.max(l,a))});else{const u=i||s;await t.forEach(o=>{const a=n.getAttribute(o,u);a==null||isNaN(a)||(r=Math.min(r,a),l=Math.max(l,a))})}return{start:r,end:l}}function ve(e,t,n){var o;if(!t||!e)return null;const{startTimeField:i,endTimeField:s}=e;if(!i&&!s)return null;const{start:r,end:l}=t;if(r===null&&l===null)return null;if(r===void 0&&l===void 0)return ge();const u=((o=n.getAttributeAsTimestamp)==null?void 0:o.bind(n))??n.getAttribute.bind(n);return i&&s?ye(u,i,s,r,l):de(u,i||s,r,l)}function ye(e,t,n,i,s){return i!=null&&s!=null?r=>{const l=e(r,t),u=e(r,n);return(l==null||l<=s)&&(u==null||u>=i)}:i!=null?r=>{const l=e(r,n);return l==null||l>=i}:s!=null?r=>{const l=e(r,t);return l==null||l<=s}:void 0}function de(e,t,n,i){return n!=null&&i!=null&&n===i?s=>e(s,t)===n:n!=null&&i!=null?s=>{const r=e(s,t);return r!=null&&r>=n&&r<=i}:n!=null?s=>{const r=e(s,t);return r!=null&&r>=n}:i!=null?s=>{const r=e(s,t);return r!=null&&r<=i}:void 0}function ge(){return()=>!1}export{Fe as I,be as P,E as a,Me as b,Ee as h,$e as n,ve as t,_e as v,Pe as y};
