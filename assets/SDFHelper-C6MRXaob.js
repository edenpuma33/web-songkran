import{o as Y}from"./floatRGBA-DH80VCn0.js";import{aB as j,aC as L,aD as z}from"./index-CorgkmYx.js";import{t as q}from"./UpdateTracking2D-CdU6XMPT.js";const v=.45;function B(n,t=.5){var e;switch(n.type){case"CIMPointSymbol":{const o=n.symbolLayers;if(!o||o.length!==1)return null;const a=o[0];return a.type!=="CIMVectorMarker"?null:B(a)}case"CIMVectorMarker":{const o=n.markerGraphics;if(!o||o.length!==1)return null;const a=o[0];if(!a)return null;const i=a.geometry;if(!i)return null;const r=a.symbol;return!r||r.type!=="CIMPolygonSymbol"&&r.type!=="CIMLineSymbol"||(e=r.symbolLayers)!=null&&e.some(l=>!!l.effects)?null:{type:"sdf",geom:i,sdfPaddingRatio:t,asFill:r.type==="CIMPolygonSymbol"}}}}function G(n){return n?n.rings?n.rings:n.paths?n.paths:n.xmin!==void 0&&n.ymin!==void 0&&n.xmax!==void 0&&n.ymax!==void 0?[[[n.xmin,n.ymin],[n.xmin,n.ymax],[n.xmax,n.ymax],[n.xmax,n.ymin],[n.xmin,n.ymin]]]:null:null}function U(n){let t=1/0,e=-1/0,o=1/0,a=-1/0;for(const i of n)for(const r of i)r[0]<t&&(t=r[0]),r[0]>e&&(e=r[0]),r[1]<o&&(o=r[1]),r[1]>a&&(a=r[1]);return new q(t,o,e-t,a-o)}function X(n){let t=1/0,e=-1/0,o=1/0,a=-1/0;for(const i of n)for(const r of i)r[0]<t&&(t=r[0]),r[0]>e&&(e=r[0]),r[1]<o&&(o=r[1]),r[1]>a&&(a=r[1]);return[t,o,e,a]}function E(n){return n?n.rings?X(n.rings):n.paths?X(n.paths):j(n)?[n.xmin,n.ymin,n.xmax,n.ymax]:null:null}function T(n,t){const[e,o,a,i]=E(n),r=a-e,l=i-o,m=L,c=z,f=Math.floor(.5*(m*t-c)),s=(m-2*(f+c))/Math.max(r,l),y=Math.round(r*s),u=Math.round(l*s);return{pixelDimensions:[r,l],texelDimensions:[Math.round((y+2*f)/s),Math.round((u+2*f)/s)]}}function W(n,t,e,o,a,i,r){const[l,m,c,f]=n;if(c<l||f<m)return{frameSizeRatio:0,anchorX:0,anchorY:0,widthRatio:1,sdfPaddingRatio:.5};const s=c-l,y=f-m,u=Math.max(s,y);let h=.5;if(i!=null&&e!=null){!r&&t!=null&&(i*=(t.ymax-t.ymin)/e);const b=i/(i+u);b>v&&b<1&&(h=Math.min(b+.1,.99))}const x=L,M=z,p=Math.floor(.5*(x*h-M)),g=(x-2*(p+M))/u,I=Math.round(s*g)+2*p,w=Math.round(y*g)+2*p;let d=1;t&&(d=w*(1-h)/((t.ymax-t.ymin)*g));let P=0,R=0,C=1;o&&(a?t&&e&&t.ymax-t.ymin>0&&(C=(t.xmax-t.xmin)/(t.ymax-t.ymin),P=o.x/(e*C),R=o.y/e):(P=o.x,R=o.y)),t&&(P=.5*(t.xmax+t.xmin)+P*(t.xmax-t.xmin),R=.5*(t.ymax+t.ymin)+R*(t.ymax-t.ymin)),P-=l,R-=m,P*=g,R*=g,P+=p,R+=p;let S=P/I-.5,D=R/w-.5;return a&&e&&(S*=e*C,D*=e),{frameSizeRatio:d,anchorX:S,anchorY:D,widthRatio:C,sdfPaddingRatio:h}}function Z(n){const t=G(n.geom),e=U(t),o=L,a=z,i=Math.floor(.5*(o*n.sdfPaddingRatio-a)),r=o-2*(i+a),l=r/Math.max(e.width,e.height),m=Math.round(e.width*l)+2*i,c=Math.round(e.height*l)+2*i,f=[];for(const y of t)if(y&&y.length>1){const u=[];for(const h of y){let[x,M]=h;x-=e.x,M-=e.y,x*=l,M*=l,x+=i-.5,M+=i-.5,n.asFill?u.push([x,M]):u.push([Math.round(x),Math.round(M)])}if(n.asFill){const h=u.length-1;u[0][0]===u[h][0]&&u[0][1]===u[h][1]||u.push(u[0])}f.push(u)}const s=H(f,m,c,i);return n.asFill&&J(f,m,c,i,s),{data:K(s,i),width:m,height:c,sdfPaddingRatio:n.sdfPaddingRatio,sdfDecodeCoeff:2*i/r}}function H(n,t,e,o){const a=t*e,i=new Array(a),r=o*o+1;for(let l=0;l<a;++l)i[l]=r;for(const l of n){const m=l.length;for(let c=1;c<m;++c){const f=l[c-1],s=l[c];let y,u,h,x;f[0]<s[0]?(y=f[0],u=s[0]):(y=s[0],u=f[0]),f[1]<s[1]?(h=f[1],x=s[1]):(h=s[1],x=f[1]);let M=Math.floor(y)-o,p=Math.floor(u)+o,g=Math.floor(h)-o,I=Math.floor(x)+o;M<0&&(M=0),p>t&&(p=t),g<0&&(g=0),I>e&&(I=e);const w=s[0]-f[0],d=s[1]-f[1],P=w*w+d*d;for(let R=M;R<p;R++)for(let C=g;C<I;C++){const S=R+.5,D=C+.5;let b,F,k=(S-f[0])*w+(D-f[1])*d;k<0?(b=f[0],F=f[1]):k>P?(b=s[0],F=s[1]):(k/=P,b=f[0]+k*w,F=f[1]+k*d);const A=(S-b)*(S-b)+(D-F)*(D-F),V=(e-C-1)*t+R;A<i[V]&&(i[V]=A)}}}for(let l=0;l<a;++l)i[l]=Math.sqrt(i[l]);return i}function J(n,t,e,o,a){for(const i of n){const r=i.length;for(let l=1;l<r;++l){const m=i[l-1],c=i[l];let f,s,y,u;m[0]<c[0]?(f=m[0],s=c[0]):(f=c[0],s=m[0]),m[1]<c[1]?(y=m[1],u=c[1]):(y=c[1],u=m[1]);let h=Math.floor(f),x=Math.floor(s)+1,M=Math.floor(y),p=Math.floor(u)+1;h<o&&(h=o),x>t-o&&(x=t-o),M<o&&(M=o),p>e-o&&(p=e-o);for(let g=M;g<p;++g){if(m[1]>g==c[1]>g)continue;const I=g+.5,w=(e-g-1)*t;for(let d=h;d<x;++d)d+.5<(c[0]-m[0])*(I-m[1])/(c[1]-m[1])+m[0]&&(a[w+d]=-a[w+d]);for(let d=o;d<h;++d)a[w+d]=-a[w+d]}}}}function K(n,t){const e=2*t,o=n.length,a=new Uint8Array(4*o);for(let i=0;i<o;++i){const r=.5-n[i]/e;Y(r,a,4*i)}return a}export{B as a,T as c,W as h,E as m,Z as u};
