const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/libtess-asm-Ms1jkM9V.js","assets/_commonjsHelpers-DCkdB7M8.js","assets/libtess-C44ppNQk.js"])))=>i.map(i=>d[i]);
import{b5 as Re,_ as Te,fG as ve,fH as pe,b7 as I,b6 as D}from"./index-CorgkmYx.js";const Me=128e3;let fe=null,me=null;async function De(){return fe||(fe=Ue()),fe}async function Ue(){me=await(Re("esri-csp-restrictions")?await Te(()=>import("./libtess-asm-Ms1jkM9V.js"),__vite__mapDeps([0,1])).then(i=>i.l):await Te(()=>import("./libtess-C44ppNQk.js"),__vite__mapDeps([2,1])).then(i=>i.l)).default({locateFile:i=>ve(`esri/core/libs/libtess/${i}`)})}function Ae(n,i){const r=Math.max(n.length,Me);return me.triangulate(n,i,r)}function Ee(n,i){return n.x===i.x&&n.y===i.y}function ke(n){if(!n)return;const i=n.length;if(i<=1)return;let r=0;for(let c=1;c<i;c++)Ee(n[c],n[r])||++r===c||(n[r]=n[c]);n.length=r+1}function k(n,i){return n.x=i.y,n.y=-i.x,n}function v(n,i){return n.x=-i.y,n.y=i.x,n}function ge(n,i){return n.x=i.x,n.y=i.y,n}function ce(n,i){return n.x=-i.x,n.y=-i.y,n}function we(n){return Math.sqrt(n.x*n.x+n.y*n.y)}function Be(n,i){return n.x*i.y-n.y*i.x}function Ve(n,i){return n.x*i.x+n.y*i.y}function te(n,i,r,c){return n.x=i.x*r+i.y*c,n.y=i.x*c-i.y*r,n}class Oe{constructor(i,r,c){this._writeVertex=i,this._writeTriangle=r,this._canUseThinTessellation=c,this._prevNormal={x:void 0,y:void 0},this._nextNormal={x:void 0,y:void 0},this._textureNormalLeft={x:0,y:1},this._textureNormalRight={x:0,y:-1},this._textureNormal={x:void 0,y:void 0},this._joinNormal={x:void 0,y:void 0},this._inner={x:void 0,y:void 0},this._outer={x:void 0,y:void 0},this._roundStart={x:void 0,y:void 0},this._roundEnd={x:void 0,y:void 0},this._startBreak={x:void 0,y:void 0},this._endBreak={x:void 0,y:void 0},this._innerPrev={x:void 0,y:void 0},this._innerNext={x:void 0,y:void 0},this._bevelStart={x:void 0,y:void 0},this._bevelEnd={x:void 0,y:void 0},this._bevelMiddle={x:void 0,y:void 0}}tessellate(i,r,c=this._canUseThinTessellation){ke(i),c&&r.halfWidth<pe&&!r.offset?this._tessellateThin(i,r):this._tessellate(i,r)}_tessellateThin(i,r){if(i.length<2)return;const c=r.wrapDistance||65535;let b=r.initialDistance||0,$=!1,C=i[0].x,F=i[0].y;const B=i.length;for(let j=1;j<B;++j){$&&($=!1,b=0);let W=i[j].x,X=i[j].y,R=W-C,w=X-F,g=Math.sqrt(R*R+w*w);if(R/=g,w/=g,b+g>c){$=!0;const e=(c-b)/g;g=c-b,W=(1-e)*C+e*W,X=(1-e)*F+e*X,--j}const l=this._writeVertex(C,F,0,0,R,w,w,-R,0,-1,b),y=this._writeVertex(C,F,0,0,R,w,-w,R,0,1,b);b+=g;const G=this._writeVertex(W,X,0,0,R,w,w,-R,0,-1,b),t=this._writeVertex(W,X,0,0,R,w,-w,R,0,1,b);this._writeTriangle(l,y,G),this._writeTriangle(y,G,t),C=W,F=X}}_tessellate(i,r){const c=i[0],b=i[i.length-1],$=Ee(c,b),C=$?3:2;if(i.length<C)return;const F=r.pixelCoordRatio,B=r.capType!=null?r.capType:I.BUTT,j=r.joinType!=null?r.joinType:D.MITER,W=r.miterLimit!=null?Math.min(r.miterLimit,4):2,X=r.roundLimit!=null?Math.min(r.roundLimit,1.05):1.05,R=r.halfWidth!=null?r.halfWidth:2,w=!!r.textured;let g,l,y,G=null;const t=this._prevNormal,e=this._nextNormal;let K=-1,Q=-1;const s=this._joinNormal;let o,u;const re=this._textureNormalLeft,xe=this._textureNormalRight,T=this._textureNormal;let d=-1,h=-1;const oe=r.wrapDistance||65535;let a=r.initialDistance||0;const Ne=this._writeVertex,be=this._writeTriangle,f=(p,se,H,m,L,A)=>{const O=Ne(l,y,o,u,H,m,p,se,L,A,a);return d>=0&&h>=0&&O>=0&&be(d,h,O),d=h,h=O,O};$&&(g=i[i.length-2],e.x=b.x-g.x,e.y=b.y-g.y,Q=we(e),e.x/=Q,e.y/=Q);let Y=!1;for(let p=0;p<i.length;++p){if(Y&&(Y=!1,a=0),g&&(t.x=-e.x,t.y=-e.y,K=Q,a+K>oe&&(Y=!0)),Y){const x=(oe-a)/K;K=oe-a,g={x:(1-x)*g.x+x*i[p].x,y:(1-x)*g.y+x*i[p].y},--p}else g=i[p];l=g.x,y=g.y;const se=p<=0&&!Y,H=p===i.length-1;if(se||(a+=K),G=H?$?i[1]:null:i[p+1],G?(e.x=G.x-l,e.y=G.y-y,Q=we(e),e.x/=Q,e.y/=Q):(e.x=void 0,e.y=void 0),!$){if(se){v(s,e),o=s.x,u=s.y,B===I.SQUARE&&(f(-e.y-e.x,e.x-e.y,e.x,e.y,0,-1),f(e.y-e.x,-e.x-e.y,e.x,e.y,0,1)),B===I.ROUND&&(f(-e.y-e.x,e.x-e.y,e.x,e.y,-1,-1),f(e.y-e.x,-e.x-e.y,e.x,e.y,-1,1)),B!==I.ROUND&&B!==I.BUTT||(f(-e.y,e.x,e.x,e.y,0,-1),f(e.y,-e.x,e.x,e.y,0,1));continue}if(H){k(s,t),o=s.x,u=s.y,B!==I.ROUND&&B!==I.BUTT||(f(t.y,-t.x,-t.x,-t.y,0,-1),f(-t.y,t.x,-t.x,-t.y,0,1)),B===I.SQUARE&&(f(t.y-t.x,-t.x-t.y,-t.x,-t.y,0,-1),f(-t.y-t.x,t.x-t.y,-t.x,-t.y,0,1)),B===I.ROUND&&(f(t.y-t.x,-t.x-t.y,-t.x,-t.y,1,-1),f(-t.y-t.x,t.x-t.y,-t.x,-t.y,1,1));continue}}let m,L,A=-Be(t,e);if(Math.abs(A)<.01)Ve(t,e)>0?(s.x=t.x,s.y=t.y,A=1,m=Number.MAX_VALUE,L=!0):(v(s,e),A=1,m=1,L=!1);else{s.x=(t.x+e.x)/A,s.y=(t.y+e.y)/A,m=we(s);const x=(m-1)*R*F;L=m>4||x>K&&x>Q}o=s.x,u=s.y;let O=j;switch(j){case D.BEVEL:m<1.05&&(O=D.MITER);break;case D.ROUND:m<X&&(O=D.MITER);break;case D.MITER:m>W&&(O=D.BEVEL)}switch(O){case D.MITER:if(f(s.x,s.y,-t.x,-t.y,0,-1),f(-s.x,-s.y,-t.x,-t.y,0,1),H)break;if(w){const x=Y?0:a;d=this._writeVertex(l,y,o,u,e.x,e.y,s.x,s.y,0,-1,x),h=this._writeVertex(l,y,o,u,e.x,e.y,-s.x,-s.y,0,1,x)}break;case D.BEVEL:{const x=A<0;let V,E,q,M;if(x){const _=d;d=h,h=_,V=re,E=xe}else V=xe,E=re;if(L)q=x?v(this._innerPrev,t):k(this._innerPrev,t),M=x?k(this._innerNext,e):v(this._innerNext,e);else{const _=x?ce(this._inner,s):ge(this._inner,s);q=_,M=_}const U=x?k(this._bevelStart,t):v(this._bevelStart,t);f(q.x,q.y,-t.x,-t.y,V.x,V.y);const ye=f(U.x,U.y,-t.x,-t.y,E.x,E.y);if(H)break;const P=x?v(this._bevelEnd,e):k(this._bevelEnd,e);if(L){const _=this._writeVertex(l,y,o,u,-t.x,-t.y,0,0,0,0,a);d=this._writeVertex(l,y,o,u,e.x,e.y,M.x,M.y,V.x,V.y,a),h=this._writeVertex(l,y,o,u,e.x,e.y,P.x,P.y,E.x,E.y,a),this._writeTriangle(ye,_,h)}else{if(w){const _=this._bevelMiddle;_.x=(U.x+P.x)/2,_.y=(U.y+P.y)/2,te(T,_,-t.x,-t.y),f(_.x,_.y,-t.x,-t.y,T.x,T.y),te(T,_,e.x,e.y),d=this._writeVertex(l,y,o,u,e.x,e.y,_.x,_.y,T.x,T.y,a),h=this._writeVertex(l,y,o,u,e.x,e.y,M.x,M.y,V.x,V.y,a)}else{const _=d;d=h,h=_}f(P.x,P.y,e.x,e.y,E.x,E.y)}if(x){const _=d;d=h,h=_}break}case D.ROUND:{const x=A<0;let V,E;if(x){const N=d;d=h,h=N,V=re,E=xe}else V=xe,E=re;const q=x?ce(this._inner,s):ge(this._inner,s);let M,U;L?(M=x?v(this._innerPrev,t):k(this._innerPrev,t),U=x?k(this._innerNext,e):v(this._innerNext,e)):(M=q,U=q);const ye=x?k(this._roundStart,t):v(this._roundStart,t),P=x?v(this._roundEnd,e):k(this._roundEnd,e),_=f(M.x,M.y,-t.x,-t.y,V.x,V.y),le=f(ye.x,ye.y,-t.x,-t.y,E.x,E.y);if(H)break;const z=this._writeVertex(l,y,o,u,-t.x,-t.y,0,0,0,0,a);L||this._writeTriangle(d,h,z);const S=ce(this._outer,q),J=this._writeVertex(l,y,o,u,e.x,e.y,P.x,P.y,E.x,E.y,a);let Z,ee;const he=m>2;if(he){let N;m!==Number.MAX_VALUE?(S.x/=m,S.y/=m,N=Ve(t,S),N=(m*(N*N-1)+1)/N):N=-1,Z=x?k(this._startBreak,t):v(this._startBreak,t),Z.x+=t.x*N,Z.y+=t.y*N,ee=x?v(this._endBreak,e):k(this._endBreak,e),ee.x+=e.x*N,ee.y+=e.y*N}te(T,S,-t.x,-t.y);const ae=this._writeVertex(l,y,o,u,-t.x,-t.y,S.x,S.y,T.x,T.y,a);te(T,S,e.x,e.y);const ue=w?this._writeVertex(l,y,o,u,e.x,e.y,S.x,S.y,T.x,T.y,a):ae,de=z,_e=w?this._writeVertex(l,y,o,u,e.x,e.y,0,0,0,0,a):z;let ie=-1,ne=-1;if(he&&(te(T,Z,-t.x,-t.y),ie=this._writeVertex(l,y,o,u,-t.x,-t.y,Z.x,Z.y,T.x,T.y,a),te(T,ee,e.x,e.y),ne=this._writeVertex(l,y,o,u,e.x,e.y,ee.x,ee.y,T.x,T.y,a)),w?he?(this._writeTriangle(de,le,ie),this._writeTriangle(de,ie,ae),this._writeTriangle(_e,ue,ne),this._writeTriangle(_e,ne,J)):(this._writeTriangle(de,le,ae),this._writeTriangle(_e,ue,J)):he?(this._writeTriangle(z,le,ie),this._writeTriangle(z,ie,ne),this._writeTriangle(z,ne,J)):(this._writeTriangle(z,le,ae),this._writeTriangle(z,ue,J)),L?(d=this._writeVertex(l,y,o,u,e.x,e.y,U.x,U.y,V.x,V.y,a),h=J):(d=w?this._writeVertex(l,y,o,u,e.x,e.y,U.x,U.y,V.x,V.y,a):_,this._writeTriangle(d,_e,J),h=J),x){const N=d;d=h,h=N}break}}}}}export{Ae as a,Oe as c,De as i};
